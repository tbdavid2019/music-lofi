<script lang="ts">
  import PresetManager from "../Controls/Settings/PresetManager.svelte";
  import InstrumentControls from "../Controls/Settings/InstrumentControls.svelte";
  import Recorder from "../Recorder/Recorder.svelte";
  import Timer from "../Timer/Timer.svelte";

  let activeSection: "presets" | "instruments" | "recorder" | "timer" | null = null;
</script>

<div class="features-guide">
  <h2>ğŸ‰ æ–°åŠŸèƒ½ä¸­å¿ƒ</h2>
  <p class="subtitle">ç›´æ¥åœ¨é€™è£¡æ“ä½œæ‰€æœ‰æ–°åŠŸèƒ½ï¼Œç„¡éœ€è·³è½‰ï¼</p>
  
  <!-- åŠŸèƒ½å¡ç‰‡é¸å–® -->
  <div class="feature-cards">
    <button 
      class="feature-card"
      class:active={activeSection === "presets"}
      on:click={() => activeSection = activeSection === "presets" ? null : "presets"}
    >
      <div class="card-icon">ğŸµ</div>
      <div class="card-content">
        <h3>é è¨­ç®¡ç†</h3>
        <p>ä¿å­˜å’Œè¼‰å…¥æ‚¨çš„é…ç½®</p>
      </div>
      <div class="card-arrow">{activeSection === "presets" ? "â–¼" : "â–¶"}</div>
    </button>

    <button 
      class="feature-card"
      class:active={activeSection === "instruments"}
      on:click={() => activeSection = activeSection === "instruments" ? null : "instruments"}
    >
      <div class="card-icon">ï¿½ï¸</div>
      <div class="card-content">
        <h3>æ¨‚å™¨æ§åˆ¶</h3>
        <p>èª¿æ•´å„æ¨‚å™¨éŸ³é‡ï¼ˆç§»é™¤é¼“è²ï¼‰</p>
      </div>
      <div class="card-arrow">{activeSection === "instruments" ? "â–¼" : "â–¶"}</div>
    </button>

    <button 
      class="feature-card"
      class:active={activeSection === "recorder"}
      on:click={() => activeSection = activeSection === "recorder" ? null : "recorder"}
    >
      <div class="card-icon">ğŸ™ï¸</div>
      <div class="card-content">
        <h3>éŒ„éŸ³åŠŸèƒ½</h3>
        <p>éŒ„è£½æ‚¨çš„ Lo-Fi éŸ³æ¨‚</p>
      </div>
      <div class="card-arrow">{activeSection === "recorder" ? "â–¼" : "â–¶"}</div>
    </button>

    <button 
      class="feature-card"
      class:active={activeSection === "timer"}
      on:click={() => activeSection = activeSection === "timer" ? null : "timer"}
    >
      <div class="card-icon">â°</div>
      <div class="card-content">
        <h3>å®šæ™‚å™¨</h3>
        <p>ç•ªèŒ„é˜ã€ç¡çœ å®šæ™‚å™¨</p>
      </div>
      <div class="card-arrow">{activeSection === "timer" ? "â–¼" : "â–¶"}</div>
    </button>
  </div>

  <!-- åŠŸèƒ½å…§å®¹å€åŸŸ -->
  {#if activeSection === "presets"}
    <div class="feature-content">
      <PresetManager />
    </div>
  {:else if activeSection === "instruments"}
    <div class="feature-content">
      <InstrumentControls />
    </div>
  {:else if activeSection === "recorder"}
    <div class="feature-content">
      <Recorder />
    </div>
  {:else if activeSection === "timer"}
    <div class="feature-content">
      <Timer />
    </div>
  {/if}

  <!-- å¿«é€Ÿæç¤º -->
  {#if !activeSection}
    <div class="quick-tips">
      <h3>ğŸ’¡ ä½¿ç”¨æç¤º</h3>
      <ul>
        <li>é»æ“Šä¸Šæ–¹å¡ç‰‡å±•é–‹åŠŸèƒ½ï¼Œç›´æ¥æ“ä½œ</li>
        <li>æ‰€æœ‰è¨­å®šè‡ªå‹•å„²å­˜åœ¨ç€è¦½å™¨ä¸­</li>
        <li>ä¹Ÿå¯ä»¥æŒ‰ <kbd>J</kbd> éµé–‹å•Ÿè¨­å®šé¢æ¿</li>
        <li>æŒ‰ <kbd>ESC</kbd> é—œé–‰æ­¤é¢æ¿</li>
      </ul>
    </div>
  {/if}
</div>

<style>
  .features-guide {
    padding: 10px 0;
  }

  h2 {
    margin: 0 0 10px 0;
    font-size: 20px;
    text-align: center;
    color: white;
  }

  .subtitle {
    text-align: center;
    margin-bottom: 20px;
    color: rgba(255, 255, 255, 0.7);
    font-size: 13px;
  }

  /* åŠŸèƒ½å¡ç‰‡é¸å–® */
  .feature-cards {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 15px;
  }

  .feature-card {
    width: 100%;
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 12px 15px;
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    text-align: left;
  }

  .feature-card:hover {
    background: rgba(0, 0, 0, 0.4);
    border-color: rgba(255, 255, 255, 0.2);
    transform: translateX(4px);
  }

  .feature-card.active {
    background: rgba(74, 144, 226, 0.25);
    border-color: rgba(74, 144, 226, 0.5);
  }

  .card-icon {
    font-size: 28px;
    flex-shrink: 0;
  }

  .card-content {
    flex: 1;
    min-width: 0;
  }

  .card-content h3 {
    margin: 0 0 3px 0;
    color: #fff;
    font-size: 15px;
  }

  .card-content p {
    margin: 0;
    color: rgba(255, 255, 255, 0.7);
    font-size: 12px;
  }

  .card-arrow {
    font-size: 16px;
    color: rgba(255, 255, 255, 0.5);
    flex-shrink: 0;
    transition: transform 0.3s ease;
  }

  .feature-card.active .card-arrow {
    transform: rotate(0deg);
  }

  /* åŠŸèƒ½å…§å®¹å€åŸŸ */
  .feature-content {
    background: rgba(0, 0, 0, 0.35);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 15px;
  }

  /* å¿«é€Ÿæç¤º */
  .quick-tips {
    background: rgba(255, 193, 7, 0.1);
    border: 1px solid rgba(255, 193, 7, 0.3);
    border-radius: 12px;
    padding: 15px;
  }

  .quick-tips h3 {
    margin: 0 0 10px 0;
    color: #ffc107;
    font-size: 15px;
  }

  .quick-tips ul {
    margin: 0;
    padding-left: 20px;
    color: rgba(255, 255, 255, 0.85);
    font-size: 13px;
  }

  .quick-tips li {
    margin: 6px 0;
    line-height: 1.5;
  }

  .quick-tips kbd {
    display: inline-block;
    padding: 2px 6px;
    background: rgba(0, 0, 0, 0.4);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 3px;
    font-family: monospace;
    font-size: 12px;
    color: #fff;
  }

  @media only screen and (max-width: 600px) {
    .feature-card {
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .card-icon {
      font-size: 35px;
    }
  }
</style>
